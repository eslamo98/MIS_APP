<div class="container-fluid py-4">
    <div class="row">
        <div class="col-12">
            <div class="mb-4">
                <h3 class="fw-bold mb-1 text-gradient">{{ t.TITLE[lang()] }}</h3>
                <p class="text-muted">{{ t.SUBTITLE[lang()] }}</p>
            </div>

            <!-- User Selection -->
            <div class="card border-0 shadow-sm rounded-4 mb-4">
                <div class="card-body p-4">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">{{ t.SELECT_USER[lang()] }}</label>
                            <select class="form-select form-select-lg rounded-3" [(ngModel)]="selectedUserId"
                                (change)="onUserChange()">
                                <option [ngValue]="null">{{ t.CHOOSE_USER[lang()] }}</option>
                                @for (user of users; track user.id) {
                                    <option [value]="user.id">{{ user.userName }} ({{ user.email }})</option>
                                }
                            </select>
                        </div>
                        @if (selectedUserId) {
                            <div class="col-md-6 text-md-end mt-3 mt-md-0">
                                <button class="btn btn-primary btn-lg rounded-pill px-4 shadow-sm" (click)="saveChanges()">
                                    <i class="bi bi-person-check me-2"></i>{{ t.SAVE_CHANGES[lang()] }}
                                </button>
                            </div>
                        }
                    </div>
                </div>
            </div>

            @if (selectedUserId) {
                <!-- Roles Grid -->
                <div class="row">
                    <div class="col-12">
                        <div class="card border-0 shadow-sm rounded-4">
                            <div class="card-header bg-light border-0 py-3 px-4">
                                <h5 class="mb-0 fw-bold">
                                    <i class="bi bi-people me-2 text-primary"></i>{{ t.AVAILABLE_ROLES[lang()] }}
                                </h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="row g-3">
                                    @for (role of rolesWithStatus; track role.id) {
                                        <div class="col-md-4 col-lg-3">
                                            <div class="role-item p-3 rounded-3 border transition-all"
                                                [class.selected]="role.selected">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        [id]="'role-' + role.id" [(ngModel)]="role.selected">
                                                    <label class="form-check-label d-block cursor-pointer"
                                                        [for]="'role-' + role.id">
                                                        <span class="fw-bold d-block">{{ role.name }}</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            } @else {
                <!-- Empty State -->
                <div class="text-center py-5">
                    <i class="bi bi-person-badge text-muted opacity-25" style="font-size: 5rem;"></i>
                    <h4 class="text-muted">{{ t.PROMPT_SELECTION[lang()] }}</h4>
                </div>
            }

        </div>
    </div>
</div>
