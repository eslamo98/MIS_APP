<div class="table-container glass-card shadow-sm overflow-hidden">
  <div class="table-responsive">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-header">
        <tr>
          @for (col of columns(); track col.key) {
            <th class="px-4 py-3 text-uppercase smaller fw-bold text-muted">
              {{ col.label }}
            </th>
          }
          @if (canEdit || canDelete || customActions.length > 0) {
            <th class="px-4 py-3 text-uppercase smaller fw-bold text-muted text-center">
              Actions
            </th>
          }
        </tr>
      </thead>
      <tbody class="table-body">
        @for (item of data(); track item) {
          <tr class="animate-row">
            @for (col of columns(); track col.key) {
              <td class="px-4 py-3">
                <!-- Image -->
                @if (col.type === 'image') {
                  <img [src]="resourceUrl + '/' + item[col.key]" alt="image"
                    class="table-image rounded-3 shadow-sm" style="max-width: 50px;" />
                }

                <!-- Default Text -->
                @if (!col.type || col.type === 'text') {
                  <span>{{ item[col.key] }}</span>
                }

                <!-- Date -->
                @if (col.type === 'date') {
                  <span class="text-muted small">
                    {{ item[col.key] | date:'mediumDate' }}
                  </span>
                }

                <!-- Badge -->
                @if (col.type === 'badge') {
                  <span class="badge bg-primary-soft text-primary rounded-pill px-3">
                    {{ item[col.key] }}
                  </span>
                }

                <!-- Currency -->
                @if (col.type === 'currency') {
                  <span class="fw-bold text-main">
                    {{ item[col.key] | currency }}
                  </span>
                }
              </td>
            }

            <!-- Actions Column -->
            @if (canEdit || canDelete || customActions.length > 0) {
              <td class="px-4 py-3 text-center">
                <div class="d-flex justify-content-center gap-2">
                  @for (action of customActions; track action.emitKey) {
                    <button (click)="onCustomAction(action.emitKey, item)"
                      [class]="'btn-action ' + (action.cssClass || 'btn-custom')"
                      [title]="action.label">
                      <i [class]="action.icon"></i>
                    </button>
                  }
                  @if (canEdit) {
                    <button (click)="onEdit(item)" class="btn-action btn-edit" title="Edit">
                      <i class="fas fa-edit"></i>
                    </button>
                  }
                  @if (canDelete) {
                    <button (click)="onDelete(item)" class="btn-action btn-delete" title="Delete">
                      <i class="fas fa-trash-alt"></i>
                    </button>
                  }
                </div>
              </td>
            }
          </tr>
        }

        <!-- Empty State -->
        @if (data().length === 0) {
          <tr>
            <td [attr.colspan]="columns().length + (canEdit || canDelete || customActions.length > 0 ? 1 : 0)"
              class="text-center py-5">
              <div class="empty-state">
                <i class="fas fa-folder-open fa-3x mb-3 text-muted opacity-25"></i>
                <p class="text-muted">No records found matching your criteria</p>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- Pagination Footer -->
  @if (isPaged() && data().length > 0) {
    <div class="p-3 border-top d-flex flex-column flex-md-row justify-content-between align-items-center gap-3">
      <div class="d-flex align-items-center gap-3">
        <span class="small text-muted">Rows per page:</span>
        <select class="form-select form-select-sm pagination-select" (change)="onPageSizeChange($event)">
          @for (size of pagination().pageSizeOptions; track size) {
            <option [value]="size" [selected]="size === pagination().pageSize">
              {{ size }}
            </option>
          }
        </select>
        <span class="small text-muted d-none d-md-inline">
          Showing {{ (pagination().pageIndex - 1) * pagination().pageSize + 1 }} to
          {{ Math.min(pagination().pageIndex * pagination().pageSize, pagination().totalCount) }} of
          {{ pagination().totalCount }}
        </span>
      </div>

      <nav aria-label="Page navigation">
        <ul class="pagination pagination-sm mb-0 gap-1">
          <li class="page-item" [class.disabled]="pagination().pageIndex === 1">
            <a class="page-link rounded-3" (click)="onPageChange(pagination().pageIndex - 1)" href="javascript:void(0)">
              <i class="fas fa-chevron-left smaller"></i>
            </a>
          </li>

          @for (page of pages; track page) {
            <li class="page-item" [class.active]="page === pagination().pageIndex">
              <a class="page-link rounded-3" (click)="onPageChange(page)" href="javascript:void(0)">{{ page }}</a>
            </li>
          }

          <li class="page-item" [class.disabled]="pagination().pageIndex === totalPages">
            <a class="page-link rounded-3" (click)="onPageChange(pagination().pageIndex + 1)" href="javascript:void(0)">
              <i class="fas fa-chevron-right smaller"></i>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  }
</div>
